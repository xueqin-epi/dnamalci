---
title: "dnamalci: functions for easily applying DNA methylation alcohol scores"
author: "Paul Yousefi"
date: "`r Sys.Date()`"
output: 
  rmarkdown::md_document: default
---


# dnamalci

`dnamalci` is an R-package that provides functions to easily apply the DNA methylation alcohol scores (DNAm-Alcs) generated and characterized in :

> Liu C, Marioni RE, Hedman ÅK, Pfeiffer L, Tsai P-C, Reynolds LM et al. A DNA methylation biomarker of alcohol consumption. Mol Psychiatry 2016. doi:10.1038/mp.2016.192.

> Yousefi PD, Richmond R, Langdon R, Ness A, Liu C, Levy D et al. Validation and characterization of a DNA methylation alcohol biomarker across the life course. bioRxiv 2019. doi:10.1101/591404.


## Installation

Only a few steps are needed to install `dnamalci` in R. Just run the following commands:

```{r, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(
comment = ">",
error = FALSE,
tidy = FALSE,
echo = TRUE, 
warning = FALSE, 
message = FALSE,
width=85,
eval = TRUE)
```

```{r, eval = F}
install.packages("devtools") # if the devtools package is not installed
library(devtools)
install_github("yousefi138/dnamalci")
```

## Example use

### Load a DNA methylation beta matrix

First, load a matrix of DNA methylation beta values of your choosing. 

`dnamalci` installs with a test dataset which is a subset of results from:

>Tsaprouni LG, Yang T-P, Bell J, Dick KJ, Kanoni S, Nisbet J et al. Cigarette smoking reduces DNA methylation levels at multiple genomic loci but the effect is partially reversible upon cessation. Epigenetics 2014; 9: 1382–1396.

This dataset is publicly available at GEO accession number [GSE50660](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE50660) : 

```{r}
library(dnamalci)
betas <- dnamalci.load.test.data()
```

The only requirements of user supplied beta values for `dnamalci` are that they:

* be contained in a matrix-formatted object where rows are CpG sites and columns are samples
* `rownames` must contain CpG site names 

```{r}
head(rownames(betas))
```

### View available DNAm-Alcs

List the 4 flavors of DNAm-Alcs from Liu et al. 2016 and Yousefi et al. 2019 that are available for implementation in `dnamalci`:

```{r}
dnamalci.models()
```

### Estimate the DNAm-Alc score from your target DNA methylation beta matrix

```{r}
dnam.alc <- dnamalci(betas)
head(dnam.alc$score)
```

By default `dnamalci()` estimates the 144 CpG model from Liu et all, but all DNAm-Alcs can be estimated by specifying the `model` argument:

```{r}
dnamalc.5cpg <- dnamalci(betas, model = "dnamalc.5cpg")
```


